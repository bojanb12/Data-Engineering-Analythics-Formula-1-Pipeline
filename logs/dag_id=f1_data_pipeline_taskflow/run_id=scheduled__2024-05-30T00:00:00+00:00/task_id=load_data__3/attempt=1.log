[2024-05-31T12:11:57.019+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T12:11:57.033+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T12:11:57.038+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T12:11:57.038+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T12:11:57.046+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T12:11:57.050+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=192) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T12:11:57.051+0000] {standard_task_runner.py:63} INFO - Started process 198 to run task
[2024-05-31T12:11:57.052+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '9', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpsjdwt1j4']
[2024-05-31T12:11:57.053+0000] {standard_task_runner.py:91} INFO - Job 9: Subtask load_data__3
[2024-05-31T12:11:57.084+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 635d0579969f
[2024-05-31T12:11:57.182+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T12:11:57.183+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T12:11:57.184+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T12:11:57.184+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T12:11:57.213+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T12:11:57.213+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "raceDim_pkey"
DETAIL:  Key ("raceId")=(863) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py", line 265, in execute
    return_value = super().execute(context)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/etl_dag.py", line 109, in load_data
    df.to_sql(table_name, engine, if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "raceDim_pkey"
DETAIL:  Key ("raceId")=(863) already exists.

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 1032 total bound parameter sets ...  {'raceId': 944, 'circuitId': 18, 'statusId': 14, 'name_x': 'Brazilian Grand Prix', 'date': '2015-11-15', 'year': 2015, 'round': 18, 'url_x': 'http://en.wikipedia.org/wiki/2015_Brazilian_Grand_Prix'}, {'raceId': 953, 'circuitId': 6, 'statusId': 14, 'name_x': 'Monaco Grand Prix', 'date': '2016-05-29', 'year': 2016, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2016_Monaco_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
[2024-05-31T12:11:57.223+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T121157, end_date=20240531T121157
[2024-05-31T12:11:57.231+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 9 for task load_data__3 ((psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "raceDim_pkey"
DETAIL:  Key ("raceId")=(863) already exists.

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 1032 total bound parameter sets ...  {'raceId': 944, 'circuitId': 18, 'statusId': 14, 'name_x': 'Brazilian Grand Prix', 'date': '2015-11-15', 'year': 2015, 'round': 18, 'url_x': 'http://en.wikipedia.org/wiki/2015_Brazilian_Grand_Prix'}, {'raceId': 953, 'circuitId': 6, 'statusId': 14, 'name_x': 'Monaco Grand Prix', 'date': '2016-05-29', 'year': 2016, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2016_Monaco_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 198)
[2024-05-31T12:11:57.264+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-05-31T12:11:57.275+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-31T12:11:57.276+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T12:15:41.842+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T12:15:41.856+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T12:15:41.861+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T12:15:41.861+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T12:15:41.870+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T12:15:41.874+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=189) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T12:15:41.875+0000] {standard_task_runner.py:63} INFO - Started process 198 to run task
[2024-05-31T12:15:41.875+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '10', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp_tbwld30']
[2024-05-31T12:15:41.877+0000] {standard_task_runner.py:91} INFO - Job 10: Subtask load_data__3
[2024-05-31T12:15:41.909+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 32d043f0486c
[2024-05-31T12:15:42.016+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T12:15:42.017+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T12:15:42.018+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T12:15:42.019+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T12:15:42.037+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T12:15:42.037+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.ForeignKeyViolation: insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py", line 265, in execute
    return_value = super().execute(context)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/etl_dag.py", line 111, in load_data
    df.to_sql(table_name, engine, if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
[2024-05-31T12:15:42.047+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T121541, end_date=20240531T121542
[2024-05-31T12:15:42.055+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 10 for task load_data__3 ((psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 198)
[2024-05-31T12:15:42.088+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-05-31T12:15:42.094+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T12:27:14.758+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T12:27:14.776+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T12:27:14.782+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T12:27:14.783+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T12:27:14.792+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T12:27:14.797+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=188) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T12:27:14.798+0000] {standard_task_runner.py:63} INFO - Started process 203 to run task
[2024-05-31T12:27:14.798+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '10', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp6dql9wlj']
[2024-05-31T12:27:14.800+0000] {standard_task_runner.py:91} INFO - Job 10: Subtask load_data__3
[2024-05-31T12:27:14.834+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 2b4626dac48c
[2024-05-31T12:27:14.969+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T12:27:14.970+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T12:27:14.971+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T12:27:14.972+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T12:27:14.997+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T12:27:14.998+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.ForeignKeyViolation: insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py", line 265, in execute
    return_value = super().execute(context)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/etl_dag.py", line 111, in load_data
    df.to_sql(table_name, engine, if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
[2024-05-31T12:27:15.015+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T122714, end_date=20240531T122715
[2024-05-31T12:27:15.025+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 10 for task load_data__3 ((psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 203)
[2024-05-31T12:27:15.051+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-05-31T12:27:15.058+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T12:31:45.669+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T12:31:45.685+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T12:31:45.690+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T12:31:45.691+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T12:31:45.699+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T12:31:45.704+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=203) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T12:31:45.705+0000] {standard_task_runner.py:63} INFO - Started process 208 to run task
[2024-05-31T12:31:45.705+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '9', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpwbyj7lbr']
[2024-05-31T12:31:45.706+0000] {standard_task_runner.py:91} INFO - Job 9: Subtask load_data__3
[2024-05-31T12:31:45.740+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 85acc91f6307
[2024-05-31T12:31:45.854+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T12:31:45.854+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T12:31:45.855+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T12:31:45.856+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T12:31:45.873+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T12:31:45.874+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.ForeignKeyViolation: insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py", line 265, in execute
    return_value = super().execute(context)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/etl_dag.py", line 111, in load_data
    df.to_sql(table_name, engine, if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
[2024-05-31T12:31:45.885+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T123145, end_date=20240531T123145
[2024-05-31T12:31:45.894+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 9 for task load_data__3 ((psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 208)
[2024-05-31T12:31:45.918+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-05-31T12:31:45.929+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-31T12:31:45.930+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T12:36:59.445+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T12:36:59.461+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T12:36:59.467+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T12:36:59.467+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T12:36:59.475+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T12:36:59.479+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=188) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T12:36:59.480+0000] {standard_task_runner.py:63} INFO - Started process 202 to run task
[2024-05-31T12:36:59.481+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '10', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp5svqrnso']
[2024-05-31T12:36:59.482+0000] {standard_task_runner.py:91} INFO - Job 10: Subtask load_data__3
[2024-05-31T12:36:59.514+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 69a8c1722b53
[2024-05-31T12:36:59.619+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T12:36:59.619+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T12:36:59.620+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T12:36:59.621+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T12:36:59.638+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T12:36:59.638+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.ForeignKeyViolation: insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py", line 265, in execute
    return_value = super().execute(context)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/etl_dag.py", line 113, in load_data
    df.to_sql(table_name, engine, if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
[2024-05-31T12:36:59.648+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T123659, end_date=20240531T123659
[2024-05-31T12:36:59.656+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 10 for task load_data__3 ((psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 202)
[2024-05-31T12:36:59.694+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-05-31T12:36:59.705+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-31T12:36:59.706+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T13:16:04.134+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T13:16:04.268+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:16:04.273+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:16:04.273+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T13:16:04.282+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T13:16:04.286+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=603) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T13:16:04.287+0000] {standard_task_runner.py:63} INFO - Started process 609 to run task
[2024-05-31T13:16:04.287+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '8', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp8tbb16cf']
[2024-05-31T13:16:04.288+0000] {standard_task_runner.py:91} INFO - Job 8: Subtask load_data__3
[2024-05-31T13:16:04.319+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 29de999fd730
[2024-05-31T13:16:04.417+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T13:16:04.418+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T13:16:04.419+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T13:16:04.419+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T13:16:04.435+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T13:16:04.436+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.ForeignKeyViolation: insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py", line 265, in execute
    return_value = super().execute(context)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/etl_dag.py", line 113, in load_data
    df.to_sql(table_name, engine, if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
[2024-05-31T13:16:04.446+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T131604, end_date=20240531T131604
[2024-05-31T13:16:04.453+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 8 for task load_data__3 ((psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_circuitId_fkey"
DETAIL:  Key (circuitId)=(1) is not present in table "circuitDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 609)
[2024-05-31T13:16:04.461+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-05-31T13:16:04.471+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-31T13:16:04.472+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T13:20:43.960+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T13:20:44.079+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:20:44.085+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:20:44.085+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T13:20:44.098+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T13:20:44.102+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=196) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T13:20:44.103+0000] {standard_task_runner.py:63} INFO - Started process 206 to run task
[2024-05-31T13:20:44.103+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '8', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp9po3suua']
[2024-05-31T13:20:44.105+0000] {standard_task_runner.py:91} INFO - Job 8: Subtask load_data__3
[2024-05-31T13:20:44.138+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 19edeffeeef7
[2024-05-31T13:20:44.239+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T13:20:44.240+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T13:20:44.241+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T13:20:44.241+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T13:20:44.258+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T13:20:44.258+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.ForeignKeyViolation: insert or update on table "raceDim" violates foreign key constraint "raceDim_statusId_fkey"
DETAIL:  Key (statusId)=(1) is not present in table "raceStatusDim".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py", line 265, in execute
    return_value = super().execute(context)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/etl_dag.py", line 113, in load_data
    df.to_sql(table_name, engine, if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_statusId_fkey"
DETAIL:  Key (statusId)=(1) is not present in table "raceStatusDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1.0, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2.0, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17.0, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3.0, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4.0, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6.0, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7.0, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12.0, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3.0, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71.0, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
[2024-05-31T13:20:44.268+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T132044, end_date=20240531T132044
[2024-05-31T13:20:44.276+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 8 for task load_data__3 ((psycopg2.errors.ForeignKeyViolation) insert or update on table "raceDim" violates foreign key constraint "raceDim_statusId_fkey"
DETAIL:  Key (statusId)=(1) is not present in table "raceStatusDim".

[SQL: INSERT INTO "raceDim" ("raceId", "circuitId", "statusId", name_x, date, year, round, url_x) VALUES (%(raceId)s, %(circuitId)s, %(statusId)s, %(name_x)s, %(date)s, %(year)s, %(round)s, %(url_x)s)]
[parameters: ({'raceId': 860, 'circuitId': 1.0, 'statusId': 1, 'name_x': 'Australian Grand Prix', 'date': '2012-03-18', 'year': 2012, 'round': 1, 'url_x': 'http://en.wikipedia.org/wiki/2012_Australian_Grand_Prix'}, {'raceId': 861, 'circuitId': 2.0, 'statusId': 1, 'name_x': 'Malaysian Grand Prix', 'date': '2012-03-25', 'year': 2012, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2012_Malaysian_Grand_Prix'}, {'raceId': 862, 'circuitId': 17.0, 'statusId': 1, 'name_x': 'Chinese Grand Prix', 'date': '2012-04-15', 'year': 2012, 'round': 3, 'url_x': 'http://en.wikipedia.org/wiki/2012_Chinese_Grand_Prix'}, {'raceId': 863, 'circuitId': 3.0, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2012-04-22', 'year': 2012, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2012_Bahrain_Grand_Prix'}, {'raceId': 864, 'circuitId': 4.0, 'statusId': 1, 'name_x': 'Spanish Grand Prix', 'date': '2012-05-13', 'year': 2012, 'round': 5, 'url_x': 'http://en.wikipedia.org/wiki/2012_Spanish_Grand_Prix'}, {'raceId': 865, 'circuitId': 6.0, 'statusId': 1, 'name_x': 'Monaco Grand Prix', 'date': '2012-05-27', 'year': 2012, 'round': 6, 'url_x': 'http://en.wikipedia.org/wiki/2012_Monaco_Grand_Prix'}, {'raceId': 866, 'circuitId': 7.0, 'statusId': 1, 'name_x': 'Canadian Grand Prix', 'date': '2012-06-10', 'year': 2012, 'round': 7, 'url_x': 'http://en.wikipedia.org/wiki/2012_Canadian_Grand_Prix'}, {'raceId': 867, 'circuitId': 12.0, 'statusId': 1, 'name_x': 'European Grand Prix', 'date': '2012-06-24', 'year': 2012, 'round': 8, 'url_x': 'http://en.wikipedia.org/wiki/2012_European_Grand_Prix'}  ... displaying 10 of 232 total bound parameter sets ...  {'raceId': 990, 'circuitId': 3.0, 'statusId': 1, 'name_x': 'Bahrain Grand Prix', 'date': '2018-04-08', 'year': 2018, 'round': 2, 'url_x': 'http://en.wikipedia.org/wiki/2018_Bahrain_Grand_Prix'}, {'raceId': 951, 'circuitId': 71.0, 'statusId': 1, 'name_x': 'Russian Grand Prix', 'date': '2016-05-01', 'year': 2016, 'round': 4, 'url_x': 'http://en.wikipedia.org/wiki/2016_Russian_Grand_Prix'})]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 206)
[2024-05-31T13:20:44.316+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-05-31T13:20:44.327+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-31T13:20:44.329+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T13:30:59.178+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T13:30:59.192+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:30:59.196+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:30:59.197+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T13:30:59.204+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T13:30:59.209+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=255) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T13:30:59.209+0000] {standard_task_runner.py:63} INFO - Started process 257 to run task
[2024-05-31T13:30:59.210+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp4s4j4x42']
[2024-05-31T13:30:59.211+0000] {standard_task_runner.py:91} INFO - Job 12: Subtask load_data__3
[2024-05-31T13:30:59.242+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 71bdf4d24007
[2024-05-31T13:30:59.329+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T13:30:59.330+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T13:30:59.331+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T13:30:59.331+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T13:30:59.343+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T13:30:59.344+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T13:30:59.350+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T133059, end_date=20240531T133059
[2024-05-31T13:30:59.382+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T13:30:59.396+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T13:30:59.397+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T13:38:34.687+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T13:38:34.702+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:38:34.707+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:38:34.708+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T13:38:34.716+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T13:38:34.720+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=246) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T13:38:34.721+0000] {standard_task_runner.py:63} INFO - Started process 248 to run task
[2024-05-31T13:38:34.721+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmplpn3aq16']
[2024-05-31T13:38:34.722+0000] {standard_task_runner.py:91} INFO - Job 12: Subtask load_data__3
[2024-05-31T13:38:34.756+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 140bbde645f4
[2024-05-31T13:38:34.852+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T13:38:34.853+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T13:38:34.854+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T13:38:34.855+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T13:38:34.867+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T13:38:34.867+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T13:38:34.873+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T133834, end_date=20240531T133834
[2024-05-31T13:38:34.894+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T13:38:34.907+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T13:38:34.908+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T13:42:25.764+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T13:42:25.778+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:42:25.784+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:42:25.784+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T13:42:25.792+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T13:42:25.797+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=246) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T13:42:25.798+0000] {standard_task_runner.py:63} INFO - Started process 248 to run task
[2024-05-31T13:42:25.798+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp0lqz6vnd']
[2024-05-31T13:42:25.800+0000] {standard_task_runner.py:91} INFO - Job 12: Subtask load_data__3
[2024-05-31T13:42:25.843+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 8abcc7a02d3d
[2024-05-31T13:42:25.936+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T13:42:25.938+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T13:42:25.939+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T13:42:25.939+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T13:42:25.952+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T13:42:25.952+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T13:42:25.959+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T134225, end_date=20240531T134225
[2024-05-31T13:42:25.971+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T13:42:25.984+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T13:42:25.989+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T13:46:04.987+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T13:46:05.002+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:46:05.007+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:46:05.007+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T13:46:05.016+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T13:46:05.020+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=253) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T13:46:05.020+0000] {standard_task_runner.py:63} INFO - Started process 255 to run task
[2024-05-31T13:46:05.021+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp7_hg2ofa']
[2024-05-31T13:46:05.023+0000] {standard_task_runner.py:91} INFO - Job 12: Subtask load_data__3
[2024-05-31T13:46:05.058+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 2605f7bd5eb2
[2024-05-31T13:46:05.143+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T13:46:05.145+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T13:46:05.146+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T13:46:05.146+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T13:46:05.158+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T13:46:05.159+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T13:46:05.165+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T134605, end_date=20240531T134605
[2024-05-31T13:46:05.194+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T13:46:05.207+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T13:46:05.208+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T13:52:42.391+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T13:52:42.407+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:52:42.412+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:52:42.412+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T13:52:42.421+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T13:52:42.426+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=251) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T13:52:42.427+0000] {standard_task_runner.py:63} INFO - Started process 253 to run task
[2024-05-31T13:52:42.427+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpyipa40_r']
[2024-05-31T13:52:42.429+0000] {standard_task_runner.py:91} INFO - Job 12: Subtask load_data__3
[2024-05-31T13:52:42.463+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host a95aa6127783
[2024-05-31T13:52:42.574+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T13:52:42.576+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T13:52:42.577+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T13:52:42.577+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T13:52:42.592+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T13:52:42.592+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T13:52:42.600+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T135242, end_date=20240531T135242
[2024-05-31T13:52:42.641+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T13:52:42.656+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T13:52:42.658+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T13:59:38.699+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T13:59:38.720+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:59:38.727+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T13:59:38.728+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T13:59:38.740+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T13:59:38.745+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=274) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T13:59:38.746+0000] {standard_task_runner.py:63} INFO - Started process 289 to run task
[2024-05-31T13:59:38.747+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpywa_o473']
[2024-05-31T13:59:38.749+0000] {standard_task_runner.py:91} INFO - Job 13: Subtask load_data__3
[2024-05-31T13:59:38.789+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host b6e8a688eec4
[2024-05-31T13:59:38.889+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T13:59:38.891+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T13:59:38.892+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T13:59:38.892+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T13:59:38.905+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T13:59:38.905+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T13:59:38.912+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T135938, end_date=20240531T135938
[2024-05-31T13:59:38.960+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T13:59:38.976+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T13:59:38.978+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T14:10:57.109+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T14:10:57.123+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:10:57.128+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:10:57.128+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T14:10:57.136+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T14:10:57.141+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=269) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T14:10:57.142+0000] {standard_task_runner.py:63} INFO - Started process 271 to run task
[2024-05-31T14:10:57.142+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp60gcpds5']
[2024-05-31T14:10:57.144+0000] {standard_task_runner.py:91} INFO - Job 13: Subtask load_data__3
[2024-05-31T14:10:57.175+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 7fde08b5b7bb
[2024-05-31T14:10:57.263+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T14:10:57.265+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T14:10:57.266+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T14:10:57.266+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T14:10:57.283+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T14:10:57.284+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T14:10:57.291+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T141057, end_date=20240531T141057
[2024-05-31T14:10:57.315+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T14:10:57.332+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T14:10:57.334+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T14:26:09.631+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T14:26:09.647+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:26:09.653+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:26:09.653+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T14:26:09.662+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T14:26:09.668+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=300) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T14:26:09.669+0000] {standard_task_runner.py:63} INFO - Started process 305 to run task
[2024-05-31T14:26:09.669+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '16', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp1sknqdp9']
[2024-05-31T14:26:09.671+0000] {standard_task_runner.py:91} INFO - Job 16: Subtask load_data__3
[2024-05-31T14:26:09.702+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host e67b5c96142c
[2024-05-31T14:26:09.790+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T14:26:09.792+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T14:26:09.793+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T14:26:09.794+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T14:26:09.806+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T14:26:09.806+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T14:26:09.813+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T142609, end_date=20240531T142609
[2024-05-31T14:26:09.842+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T14:26:09.862+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T14:26:09.863+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T14:34:41.289+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T14:34:41.304+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:34:41.309+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:34:41.310+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T14:34:41.318+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T14:34:41.323+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=331) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T14:34:41.324+0000] {standard_task_runner.py:63} INFO - Started process 353 to run task
[2024-05-31T14:34:41.324+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '17', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpu9osjl00']
[2024-05-31T14:34:41.326+0000] {standard_task_runner.py:91} INFO - Job 17: Subtask load_data__3
[2024-05-31T14:34:41.357+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host b904eb6286a6
[2024-05-31T14:34:41.448+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T14:34:41.449+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T14:34:41.450+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T14:34:41.451+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T14:34:41.464+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T14:34:41.464+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T14:34:41.471+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T143441, end_date=20240531T143441
[2024-05-31T14:34:41.497+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T14:34:41.516+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T14:34:41.518+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T14:41:22.793+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T14:41:22.932+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:41:22.939+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:41:22.939+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T14:41:22.948+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T14:41:22.954+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=359) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T14:41:22.955+0000] {standard_task_runner.py:63} INFO - Started process 378 to run task
[2024-05-31T14:41:22.955+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '19', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpayni_364']
[2024-05-31T14:41:22.957+0000] {standard_task_runner.py:91} INFO - Job 19: Subtask load_data__3
[2024-05-31T14:41:22.995+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 39ebc24e8ca6
[2024-05-31T14:41:23.096+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T14:41:23.097+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T14:41:23.098+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T14:41:23.098+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T14:41:23.114+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T14:41:23.114+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T14:41:23.122+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T144122, end_date=20240531T144123
[2024-05-31T14:41:23.169+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T14:41:23.188+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T14:41:23.190+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T14:44:43.322+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T14:44:43.337+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:44:43.343+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:44:43.343+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T14:44:43.352+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T14:44:43.357+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=341) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T14:44:43.358+0000] {standard_task_runner.py:63} INFO - Started process 358 to run task
[2024-05-31T14:44:43.358+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '17', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp0atvx3af']
[2024-05-31T14:44:43.360+0000] {standard_task_runner.py:91} INFO - Job 17: Subtask load_data__3
[2024-05-31T14:44:43.395+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host a9750641015b
[2024-05-31T14:44:43.517+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T14:44:43.519+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T14:44:43.521+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T14:44:43.521+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T14:44:43.538+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T14:44:43.539+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T14:44:43.546+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T144443, end_date=20240531T144443
[2024-05-31T14:44:43.571+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T14:44:43.590+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T14:44:43.592+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-31T14:48:49.069+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-31T14:48:49.085+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:48:49.091+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [queued]>
[2024-05-31T14:48:49.091+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-05-31T14:48:49.100+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_data__3> on 2024-05-30 00:00:00+00:00
[2024-05-31T14:48:49.106+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=375) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-31T14:48:49.107+0000] {standard_task_runner.py:63} INFO - Started process 377 to run task
[2024-05-31T14:48:49.107+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'f1_data_pipeline_taskflow', 'load_data__3', 'scheduled__2024-05-30T00:00:00+00:00', '--job-id', '18', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpo38_2f1_']
[2024-05-31T14:48:49.109+0000] {standard_task_runner.py:91} INFO - Job 18: Subtask load_data__3
[2024-05-31T14:48:49.142+0000] {task_command.py:426} INFO - Running <TaskInstance: f1_data_pipeline_taskflow.load_data__3 scheduled__2024-05-30T00:00:00+00:00 [running]> on host 5e099e29bc21
[2024-05-31T14:48:49.238+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='f1_data_pipeline_taskflow' AIRFLOW_CTX_TASK_ID='load_data__3' AIRFLOW_CTX_EXECUTION_DATE='2024-05-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-30T00:00:00+00:00'
[2024-05-31T14:48:49.238+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-31T14:48:49.240+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-05-31T14:48:49.240+0000] {base.py:84} INFO - Using connection ID 'sourcedb_connection' for task execution.
[2024-05-31T14:48:49.254+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-31T14:48:49.255+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-31T14:48:49.262+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=f1_data_pipeline_taskflow, task_id=load_data__3, run_id=scheduled__2024-05-30T00:00:00+00:00, execution_date=20240530T000000, start_date=20240531T144849, end_date=20240531T144849
[2024-05-31T14:48:49.281+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-31T14:48:49.298+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-31T14:48:49.300+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
